<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>

        <record id="view_order_form" model="ir.ui.view">
            <field name="name">view_order_form</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
             <field name="type">form</field>
            <field name="arch" type="xml">
                <group name="order_details" position="after">
                    <group name="multi_warehouses">
                        <field name="is_multi_wh_line" class="o_light_label" widget="radio" readonly="state in ('sale', 'done', 'cancel')"/>
                    </group>
                </group>

                <xpath expr="/form/sheet/notebook/page[@name='order_lines']/field/tree/field[@name='product_uom_qty']" position="before">
                    <field name="sale_warehouse_ids" string="Warehouses" widget="many2many_tags" force_save="1"
                           options="{'no_open': True, 'no_create': True, 'no_quick_create': True, 'no_edit': True}"
                           column_invisible="parent.is_multi_wh_line in ('0', '2')" readonly="state in ('sale','done')"/>
                    <field name="sale_warehouse_id" string="Warehouses"
                           options="{'no_open': True, 'no_create': True, 'no_quick_create': True, 'no_edit': True}"
                           column_invisible="parent.is_multi_wh_line in ('1', '2')" force_save="1" required="parent.is_multi_wh_line == '0' and not display_type" readonly="state in ('sale','done')" />
                </xpath>
                <xpath expr="/form/sheet/notebook/page[@name='order_lines']/field/tree/field[@name='price_total']" position="after">
                    <field name="show_button_warehouse" column_invisible="1"/>
                    <button name="action_select_warehouse" class="oe_highlight" type="object" string="Warehouses"
                            invisible="not show_button_warehouse or parent.is_multi_wh_line != '1'"/>
                </xpath>

            </field>
        </record>

    </data>
</odoo>